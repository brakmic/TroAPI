webpackJsonp([1],{196:function(t,e,n){"use strict";var i=n(213);n.d(e,"a",function(){return i.a})},197:function(t,e,n){"use strict";var i=n(214);n.d(e,"b",function(){return i.a});var r=n(216);n.d(e,"a",function(){return r.a})},212:function(t,e,n){n(700)},213:function(t,e,n){"use strict";(function(t){var i=n(212),r=(n.n(i),n(114)),o=(n.n(r),n(116)),s=(n.n(o),n(168)),a=(n.n(s),n(164)),u=(n.n(a),n(167)),c=(n.n(u),n(163));n.n(c);n.d(e,"a",function(){return d});var l=(n(408),n(113),"http://troisdorf.de/web/de/stadt_rathaus/buergerservice/dienstleistungen.htm?selection="),p=n(709)("App"),d=function(){function e(t,e){this.scanner=t,this.search=e,this.root="#page-list-root",this.siteRoot="http://localhost:3000/buergerservice/",this.loadDocuments(),this.initSearchTools()}return e.prototype.loadDocuments=function(){var e=this,n=t(""+this.root),i=["035","036","067","096","045","049","042","041"];this.pagesSubscription=this.scanner.getPages().subscribe(function(i){i.then(function(i){e.search.addDocument(i).then(function(t){return p(t)}),n.append(e.getListGroupItemTemplate(i.id+"-root",i.title));var o=t("#"+i.id+"-root");r.isEmpty(i.documents)||(o.append(e.getListGroupItemTemplate(i.id+"-documents","Dokumente")),r.each(i.documents,function(n){t("#"+i.id+"-documents").append(e.getListGroupItemEntryTemplate(n.url,n.title))})),r.isEmpty(i.attachments)||(o.append(e.getListGroupItemTemplate(i.id+"-attachments","Anhänge")),r.each(i.attachments,function(n){t("#"+i.id+"-attachments").append(e.getListGroupItemEntryTemplate(n.url,n.title))})),r.isEmpty(i.linkList)||(o.append(e.getListGroupItemTemplate(i.id+"-linklist","Links")),r.each(i.linkList,function(n){t("#"+i.id+"-linklist").append(e.getListGroupItemEntryTemplate(n.url,n.title))})),r.isEmpty(i.noList)||(o.append(e.getListGroupItemTemplate(i.id+"-nolist","Weiterführende Links")),r.each(i.noList,function(n){t("#"+i.id+"-nolist").append(e.getListGroupItemEntryTemplate(n.url,n.title))})),r.isEmpty(i.contacts)||(o.append('\n              <a href="#'+i.id+'-contacts" class="list-group-item" data-toggle="collapse">\n                <i class="glyphicon glyphicon-chevron-right"></i>Ansprechpartner\n              </a>\n              <div class="list-group collapse" id="'+i.id+'-contacts">\n                <div class="panel panel-default">\n                  <div class="panel-body">\n                    <table class="table table-striped">\n                      <thead>\n                        <tr>\n                          <th>Kontakt</th>\n                          <th>Telefon</th>\n                          <th>Fax</th>\n                          <th>Email</th>\n                        </tr>\n                      </thead>\n                      <tbody id="'+i.id+'-address-rows">\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              </div>\n            '),r.each(i.contacts,function(e){t("#"+i.id+"-address-rows").append("<tr>\n                   <td>"+e.fullName+"</td>\n                   <td>"+e.phone+"</td>\n                   <td>"+e.fax+"</td>\n                   <td>"+e.email+"</td>\n                </tr>")})),t(function(){t(".list-group-item").unbind("click"),t(".list-group-item").on("click",function(){t(".glyphicon",e).toggleClass("glyphicon glyphicon-chevron-up glyphicon glyphicon-chevron-down")})})})}),r.each(i,function(t){return e.scanner.next(e.siteRoot+t)})},e.prototype.initSearchTools=function(){var e=this,n="do-search",i="search-term",o='\n<div class="panel">\n    <div class="panel-heading">Suche</div>\n    <div class="panel-body">\n      <div class="input-group">\n        <input id="'+i+'" type="text" class="form-control" placeholder="Suchen nach...">\n        <span class="input-group-btn">\n          <button id="'+n+'" class="btn btn-default" type="button">Los!</button>\n        </span>\n      </div>\n    </div>\n</div>\n      ';t("#search-tools").append(o),t("#"+n).on("click",function(){var n=t("#search-results").empty().append('<div class="list-group"></div>'),o=t("#"+i).val();e.search.search(o).then(function(t){r.each(t,function(t){e.search.getDocument(t.ref).then(function(t){var e=t.url;if(e.includes("localhost")){var i=e.split("/");e=""+l+i[i.length-1]}n.append('<li class="list-group-item">\n              <a href="'+e+'">'+t.title+"</a>\n              </li>")})})})})},e.prototype.getListGroupItemTemplate=function(t,e){return'\n              <a href="#'+t+'" class="list-group-item" data-toggle="collapse">\n                <i class="glyphicon glyphicon-chevron-right"></i>'+e+'\n              </a>\n               <div class="list-group collapse" id="'+t+'"></div>\n            '},e.prototype.getListGroupItemEntryTemplate=function(t,e){return' <a href="'+t+'" class="list-group-item">'+e+'\n                  <span class="glyphicon glyphicon-download"></span></a>\n                </a>\n              '},e}()}).call(e,n(19))},214:function(t,e,n){"use strict";var i=n(215);n.d(e,"a",function(){return i.a})},215:function(t,e,n){"use strict";var i=n(701),r=n(12),o=(n.n(r),n(116)),s=(n.n(o),n(166)),a=(n.n(s),n(165)),u=(n.n(a),n(114));n.n(u);n.d(e,"a",function(){return p});var c=n(113),l=n(156),p=function(t){function e(){var e=t.call(this)||this;return e.unwantedEntries=["E-Mail senden ..."],e.rootUrl="http://www.troisdorf.de",e}return i.a(e,t),e.prototype.getPages=function(){var t=this;return this.asObservable().map(function(e){return fetch(e).then(function(t){return t.text()}).then(function(n){return t.parse(e,n)})})},e.prototype.parse=function(t,e){var n=this,i={id:l(),url:t,documents:[],contacts:[],attachments:[],noList:[]},r=c.parse(e),o=r.querySelector("#col3_content"),s=o.childNodes,a=r.querySelector("#i4mindexsearchhidecontent"),p=r.querySelector("#I4mIndexSearchTitle"),d=u.filter(s,function(t){return"p"===t.tagName}).map(function(t){return u.replace(u.trim(t.text,"\r \n"),/\s+/g," ")}).join(" ");i.title=p.structuredText,i.info=d;var f=this.getNoList(o);u.isEmpty(f)||(i.noList=f);var h=r.querySelectorAll(".box");return u.each(h,function(t){var e=n.getDocumentList(t);u.isEmpty(e)||(i.documents=e);var r=n.getAttachmentList(t);u.isEmpty(r)||(i.attachments=r);var o=n.getLinkList(t);u.isEmpty(o)||(i.linkList=o),i.contacts=n.getContactList(a)}),i},e.prototype.getDocumentList=function(t){var e=this,n=[],i=t.querySelector(".dlist");if(!u.isEmpty(i)){var r=this.getItemList(i.childNodes),o=u.flatMap(r,function(t){return e.getAnchorList(t.childNodes)});n=u.flatMap(o,function(t){return e.getHrefList([t],"http://www.troisdorf.de")})}return n},e.prototype.getAttachmentList=function(t){var e=this,n=[],i=t.querySelector(".dlist");if(!u.isEmpty(i)){var r=this.getItemList(i.childNodes);u.each(r,function(t){var i=u.filter(t.childNodes,function(t){return"div"===t.tagName});u.each(i,function(t){var i=e.getAnchorList(t.childNodes),r=e.getHrefList(i,e.rootUrl);u.concat(n,r)})})}return n},e.prototype.getContactList=function(t){var e=this,n=[],i=t.querySelector(".listTable");if(!u.isNil(i)){var r=this.getTableRows(i.childNodes);n=u.map(r,function(t){var n=e.extractContactData(t.childNodes),i=u.split(t.structuredText,"\n").filter(function(t){return!e.unwantedEntries.includes(t)}),r=u.split(u.toString(n[0]),","),o=u.toString(n[1]);return{fullName:u.trim(r[1])+" "+u.trim(r[0]),firstName:u.trim(r[1]),lastName:u.trim(r[0]),email:o,phone:u.trim(u.replace(u.toString(n[2]),"Tel.","")),fax:u.trim(u.replace(u.toString(n[3]),"Fax","")),address:i[3],room:i[4]}})}return n},e.prototype.getNoList=function(t){var e=this,n=[],i=t.querySelector(".nolist");if(!u.isEmpty(i)){var r=this.getItemList(i.childNodes);n=u.flatMap(r,function(t){var n=e.getAnchorList(t.childNodes);return e.getHrefList(n)})}return n},e.prototype.getLinkList=function(t){var e=this,n=[],i=t.querySelectorAll(".ext");return u.isEmpty(i)||(n=u.flatMap(i,function(t){var n=e.getAnchorList(t.childNodes);return e.getHrefList(n)})),n},e.prototype.getItemList=function(t){return u.filter(t,function(t){return"li"===t.tagName})},e.prototype.getAnchorList=function(t){return u.filter(t,function(t){return"a"===t.tagName})},e.prototype.getTableRows=function(t){var e=[],n=u.find(t,function(t){return"tbody"===t.tagName});return u.isNil(n)||(e=u.filter(n.childNodes,function(t){return"tr"===t.tagName})),e},e.prototype.getTableDatas=function(t){return u.flatMap(t,function(t){return u.filter(t.childNodes,function(t){return"td"===t.tagName})})},e.prototype.extractContactData=function(t){var e=this,n=[];return n=u.flatMap(t,function(t){return u.map(t.childNodes,function(t){if("p"===t.tagName){var n=e.extractEMail(t);if(!u.isNil(n))return n}return"p"===t.tagName||"span"===t.tagName||"h5"===t.tagName?t.text:""})}),u.filter(n,function(t){return!u.isEmpty(t)})},e.prototype.extractEMail=function(t){var e=u.find(t.childNodes,function(t){return"input"===t.tagName});if(!u.isEmpty(e))return e.rawAttributes.value},e.prototype.getHrefList=function(t,e){return void 0===e&&(e=""),u.map(t,function(t){return{title:u.trim(t.structuredText),url:""+e+t.attributes.href}})},e}(r.Subject)},216:function(t,e,n){"use strict";var i=n(217);n.d(e,"a",function(){return i.a})},217:function(t,e,n){"use strict";var i=n(114);n.n(i);n.d(e,"a",function(){return s});var r=(n(113),n(156)),o=n(409),s=function(){function t(){this.init()}return t.prototype.addDocument=function(t){return this.index.addDoc({id:t.id,title:t.title,info:t.info,url:t.url}),Promise.resolve({id:r(),docId:t.id,succeeded:!0,timeStamp:(new Date).toString()})},t.prototype.getDocument=function(t){return Promise.resolve(this.index.documentStore.getDoc(t))},t.prototype.search=function(t){var e=this.index.search(t),n=i.map(e,function(t){return{ref:t.ref,score:t.score}});return Promise.resolve(n)},t.prototype.init=function(){this.index=o(function(){this.addField("title"),this.addField("info"),this.addField("url")})},t}()},427:function(t,e){t.exports='exports = module.exports = require("../../node_modules/css-loader/lib/css-base.js")(undefined);\n// imports\n\n\n// module\nexports.push([module.id, ".just-padding{padding:15px}.list-group.list-group-root{padding:0;overflow:hidden}.list-group.list-group-root .list-group{margin-bottom:0}.list-group.list-group-root .list-group-item{border-radius:0;border-width:1px 0 0}.list-group.list-group-root>.list-group-item:first-child{border-top-width:0}.list-group.list-group-root>.list-group>.list-group-item{padding-left:30px}.list-group.list-group-root>.list-group>.list-group>.list-group-item{padding-left:45px}.list-group-item .glyphicon{margin-right:5px}.troisdorf-test-app{padding-top:2em}", ""]);\n\n// exports\n'},700:function(t,e,n){var i=n(427);t.exports="string"==typeof i?i:i.toString()},709:function(t,e,n){(function(){function e(){if("undefined"==typeof window||"undefined"==typeof navigator)return!1;var t,e=!!window.chrome,n=/firefox/i.test(navigator.userAgent),i=void 0;if(n){var r=navigator.userAgent.match(/Firefox\/(\d+\.\d+)/);r&&r[1]&&Number(r[1])&&(t=Number(r[1]))}return e||t>=31||i}var i=function(){return l+=.618033988749895,360*(l%=1)},r="undefined"==typeof window,o=!r&&window.localStorage,s=o.andlogKey||"debug",a=o[s],u=n(210),c=Function.prototype.bind,l=0,p=15,d=function(){},f=o.debugColors?"false"!==o.debugColors:e(),h=null,g=null,m=!1,v={};a&&"!"===a[0]&&"/"===a[1]&&(m=!0,a=a.slice(1)),g=a&&"/"===a[0]&&new RegExp(a.substring(1,a.length-1));for(var y=["log","debug","warn","error","info"],b=0,L=y.length;b<L;b++)d[y[b]]=d;h=function(t){var e,n,r;if(e=t.slice(0,p),e+=Array(p+3-e.length).join(" ")+"|",g){var o=t.match(g);if(!m&&!o||m&&o)return d}if(!c)return d;var s=[u];if(f){v[t]||(v[t]=i());var a=v[t];e="%c"+e,n="color: hsl("+a+",99%,40%); font-weight: bold",s.push(e,n)}else s.push(e);if(arguments.length>1){var l=Array.prototype.slice.call(arguments,1);s=s.concat(l)}return r=c.apply(u.log,s),y.forEach(function(t){r[t]=c.apply(u[t]||r,s)}),r},h.config=function(t){t.padLength&&(p=t.padLength)},t.exports=h}).call()},710:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(196),r=n(197),o=new r.a,s=new r.b,a=new i.a(s,o);window.TroApi={app:a,scanner:s,search:o}}},[710]);